<!DOCTYPE html>
<!-- saved from url=(0051)http://jun-lu.github.io/jun/canvas_sin_cos_tan.html -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>平面坐标</title>

	 <script src="Coordinate.js"></script>
	 <script src="libs/dat.gui.js"></script>
</head>
<body>
	<h1>使用 canvas 在平面坐标系中打印数学函数图像</h1>
	<canvas id="tutorial" width="1000" height="500">非常抱歉您的浏览器不支持 canvas</canvas>	
	<script>
		function init() {
			var canvas = document.getElementById('tutorial');

			var pc = new PlaneCoordinate(canvas);

			pc.setProportion(0.02);
			pc.setCalibration(50);
			pc.init();
			pc.draw();

			function Mathematical() {
			}

			//y=sin(x)、y=cos(x)
			var p = Mathematical.prototype;
			p.trigonometric = function(name) {
				name = name.match(/^y=(.*)\(x\)$/);
				return function(x){
					return Math[name[1]](x);
				}
			}

			//y=kx+b
			p.proportional=function(name){
				name = name.match(/^y=(-?\d?)x(\+|\-)?(.*)/);
				!name[2] && (name[2] = "");
				var k = name[1] || 0;
				var b = name[3] ? name[2] +name[3]:""
				return new Function('x', 'return '+k +" * x " +  b);  
			}

			//y=ax²+bx+c
			p.parabola = function(name){
				name = name.match(/^y=(-?(\d\/?\d|\d)?)\*?x\*x([\+|\-]?\d?)\*?x?([\+|\-]?\d?)/);
				var a = parseFloat(name[1]) || 1;
				var b = parseFloat(name[2]) || 0;
				var c = parseFloat(name[3]) || 0;

				return function(x){
					return a * x * x + b * x + c;
				}
			}

			p.circle = function(name){
				
			}
			
			p.draw = function(name,type){
				var func = this[type](name);
				//if(flag == 1){
					for (var i = -2 * Math.PI; i < 2 * Math.PI; i += 0.03) {
						var x = i;
						var y = func(x); //生成函数
    					pc.setFillColor("#00f");
						var p = pc.project(x, y);
						pc.drawPoint(p.x, p.y);
					}
				/*}else{
					for (var i = -1; i < 1; i += 0.001) {
						var x = i;
						var func = this.getFunction(name);
						var y = func(x);
						var p = pc.project(x, y);
						pc.drawPoint(p.x, p.y);
					}
				}*/
			}
			var mathematical = new Mathematical();
		    mathematical.draw('y=sin(x)','trigonometric');

	   		var controls = new function () {
	            this.trigonometric  ='y=sin(x)'; //三角函数
	            this.proportional  ='y=2x'; //三角函数
	            this.parabola  ='y=x*x'; //三角函数
	            this.circle  ='x²+y²=r²'; //圆方程
	        }
	        var gui = new dat.GUI();
			gui.add(controls, 'trigonometric', ['y=sin(x)', 'y=cos(x)', 'y=tan(x)','y=asin(x)','y=acos(x)','y=atan(x)']).onChange(function (e) {
				pc.init();
				pc.draw()
		        mathematical.draw(e,'trigonometric');
		    });
			gui.add(controls, 'proportional', ['y=2x', 'y=-2x', 'y=4x','y=2x+2','y=2x-2','y=-2x']).onChange(function (e) {
				pc.init();
				pc.draw()
		        mathematical.draw(e,'proportional');
		    });
			gui.add(controls, 'parabola', ['y=1/2*x*x', 'y=x*x', 'y=2*x*x', 'y=3*x*x','y=2*x*x+3x-1']).onChange(function (e) {
				pc.init();
				pc.draw()
		        mathematical.draw(e,'parabola');
		    });

			gui.add(controls, 'circle', ['x²+y²=r²']).onChange(function (e) {
				pc.init();
				pc.draw()
		        mathematical.draw(e,'parabola');
		    });

			

		}
		window.onload = init;
	</script>
</body>
</html>